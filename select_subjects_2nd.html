<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>2학년 과목 선택</title>
  <style>
    /* 스타일은 기본적으로 선택창에 맞게 디자인 */
    body {
      font-family: 'Poppins', sans-serif;
      background: #f4f4f4;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
    }
    .container {
      background: white;
      padding: 40px;
      border-radius: 16px;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
      width: 100%;
      max-width: 600px;
    }
    h1 {
      font-size: 24px;
      margin-bottom: 20px;
    }
    .subject-option {
      margin-bottom: 10px;
    }
    select {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      margin-top: 8px;
      border-radius: 8px;
      border: 1px solid #ccc;
    }
    button {
      width: 100%;
      padding: 12px;
      background: #0078d7;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      margin-top: 20px;
    }
    button:disabled {
      background: #ccc;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>과목을 선택하세요</h1>

    <!-- A반 선택 -->
    <div id="A" class="subject-option">
      <h2>A반 선택 과목</h2>
      <select id="A-subjects">
        <option value="">과목을 선택하세요</option>
        <option value="세계사">세계사</option>
        <option value="사회문제탐구(A1)">사회문제탐구(A1)</option>
        <option value="윤리와사상(A1)">윤리와 사상(A1)</option>
        <option value="윤리와사상(A2)">윤리와 사상(A2)</option>
        <option value="사회문제탐구(A2)">사회문제탐구(A2)</option>
        <option value="물리학">물리학</option>
        <option value="생명과학">생명과학</option>
        <option value="화학(A1)">화학(A1)</option>
        <option value="화학(A2)">화학(A2)</option>
        <option value="지구과학">지구과학</option>
      </select>
    </div>

    <!-- B반 선택 -->
    <div id="B" class="subject-option">
      <h2>B반 선택 과목</h2>
      <select id="B-subjects">
        <option value="">과목을 선택하세요</option>
        <option value="사회문제탐구(B1)">사회문제탐구(B1)</option>
        <option value="정치와법">정치와 법</option>
        <option value="사회문제탐구(B2)">사회문제탐구(B2)</option>
        <option value="생명과학(B1)">생명과학(B1)</option>
        <option value="윤리와사상(B1)">윤리와 사상(B1)</option>
        <option value="윤리와사상(B2)">윤리와 사상(B2)</option>
        <option value="화학(B1)">화학(B1)</option>
        <option value="생명과학(B2)">생명과학(B2)</option>
        <option value="지구과학">지구과학</option>
      </select>
    </div>

    <!-- C반 선택 -->
    <div id="C" class="subject-option">
      <h2>C반 선택 과목</h2>
      <select id="C-subjects">
        <option value="">과목을 선택하세요</option>
        <option value="물리학">물리학</option>
        <option value="세계사">세계사</option>
        <option value="정치와법">정치와 법</option>
        <option value="화학">화학</option>
        <option value="지구과학">지구과학</option>
        <option value="사회문제탐구">사회문제탐구</option>
        <option value="윤리와사상(C1)">윤리와 사상(C1)</option>
        <option value="윤리와사상(C2)">윤리와 사상(C2)</option>
        <option value="생명과학(C1)">생명과학(C1)</option>
        <option value="생명과학(C2)">생명과학(C2)</option>
      </select>
    </div>

    <!-- 선택 완료 버튼 -->
    <button id="selectBtn" onclick="saveSelection()" disabled>선택 완료</button>
  </div>

 <script>
  // 선택 버튼 활성화 조건: A, B, C 반의 과목이 모두 선택되어야 함
  function enableButton() {
    const A = document.getElementById("A-subjects").value;
    const B = document.getElementById("B-subjects").value;
    const C = document.getElementById("C-subjects").value;
    document.getElementById("selectBtn").disabled = !(A && B && C); // A, B, C가 모두 선택되었을 때만 버튼 활성화
  }

  // 과목이 변경될 때마다 버튼 활성화 체크
  document.getElementById("A-subjects").addEventListener("change", enableButton);
  document.getElementById("B-subjects").addEventListener("change", enableButton);
  document.getElementById("C-subjects").addEventListener("change", enableButton);

  // 선택 완료 버튼 클릭 시 선택된 과목 저장
  function saveSelection() {
    const A = document.getElementById("A-subjects").value;
    const B = document.getElementById("B-subjects").value;
    const C = document.getElementById("C-subjects").value;

    const selectedClass = localStorage.getItem('selectedClass');
    if (!selectedClass) {
      alert("먼저 반을 선택해주세요!");
      window.location.href = "select_class.html"; // 반 선택 페이지로 리디렉션
      return;
    }

    // --- 여기부터 localStorage 저장 방식 수정 ---
    // schedule.html의 timetable 2학년 데이터를 기반으로 A, B, C의 위치를 매핑합니다.
    // 이 매핑은 schedule.html에 정의된 2학년 시간표의 A, B, C 자리와 일치해야 합니다.
    // 만약 schedule.html의 2학년 시간표에서 A, B, C의 위치가 다르다면 이 부분을 수정해야 합니다.

    const subjectsToSave = {};

    // 2학년 1반 시간표 (예시: schedule.html의 2-1 시간표 구조 참조)
    // "월요일": ["자율", "영3", "A", "C", "수2", "수1", "문1"],
    // "화요일": ["수2", "영4", "수1", "일본", "일본", "B", "문2"],
    // "수요일": ["영2", "A", "미술", "수2", "C", "체육"],
    // "목요일": ["C", "B", "체육", "문3", "A", "영1"],
    // "금요일": ["B", "미술", "수1", "인공", "문4", "창체"]

    // schedule.html의 각 2학년 반 시간표에서 A, B, C가 들어갈 인덱스를 정확히 찾아야 합니다.
    // 현재 `schedule.html`의 2학년 시간표를 기준으로 매핑한 예시입니다.
    // 만약 2학년 다른 반의 A,B,C 위치가 다르다면, 해당 반에 대한 개별 처리가 필요합니다.
    // 여기서는 일단 모든 2학년 반이 A, B, C 과목을 같은 요일/교시 패턴으로 가진다고 가정합니다.

    // 월요일: A(2교시 인덱스), C(3교시 인덱스)
    // 화요일: B(5교시 인덱스)
    // 수요일: A(1교시 인덱스), C(4교시 인덱스)
    // 목요일: C(0교시 인덱스), B(1교시 인덱스), A(4교시 인덱스)
    // 금요일: B(0교시 인덱스)

    subjectsToSave['월요일'] = [];
    subjectsToSave['월요일'][2] = A; // 월요일 3교시
    subjectsToSave['월요일'][3] = C; // 월요일 4교시

    subjectsToSave['화요일'] = [];
    subjectsToSave['화요일'][5] = B; // 화요일 6교시

    subjectsToSave['수요일'] = [];
    subjectsToSave['수요일'][1] = A; // 수요일 2교시
    subjectsToSave['수요일'][4] = C; // 수요일 5교시

    subjectsToSave['목요일'] = [];
    subjectsToSave['목요일'][0] = C; // 목요일 1교시
    subjectsToSave['목요일'][1] = B; // 목요일 2교시
    subjectsToSave['목요일'][4] = A; // 목요일 5교시

    subjectsToSave['금요일'] = [];
    subjectsToSave['금요일'][0] = B; // 금요일 1교시


    // 기존 localStorage 데이터를 가져와 현재 반의 선택 과목만 업데이트
    let allSelectedSubjects = JSON.parse(localStorage.getItem('selectedSubjects') || '{}');
    allSelectedSubjects[selectedClass] = subjectsToSave;

    localStorage.setItem("selectedSubjects", JSON.stringify(allSelectedSubjects));
    // --- localStorage 저장 방식 수정 끝 ---

    alert('선택 완료!');
    window.location.href = "schedule.html"; // 시간표 페이지로 이동
  }
</script>
</body>
</html>
